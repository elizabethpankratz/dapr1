## ----setup------------------------------------------------------------------------------------------
#| include: false

source('assets/setup.R')


## ----include=FALSE----------------------------------------------------------------------------------
knitr::opts_chunk$set(fig.align = 'center', 
                      fig.height = 5, fig.width = 6.2, 
                      out.width = '80%')

set.seed(1)

library(tidyverse)
library(patchwork)
library(kableExtra)

theme_set(theme_light(base_size = 15))


## ----echo=FALSE, fig.cap = "The t-distribution. (Source: https://en.wikipedia.org/wiki/Student%27s_t-distribution)", out.width = '80%'----
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Student_t_pdf.svg/1024px-Student_t_pdf.svg.png")


## ---------------------------------------------------------------------------------------------------
pt(-2, df = 5)


## ---------------------------------------------------------------------------------------------------
qt(.05, df = 5)


## ---------------------------------------------------------------------------------------------------
qt(.025, df = 5)
qt(.975, df = 5) 


## ---------------------------------------------------------------------------------------------------
library(tidyverse)
temp_data <- read_csv('https://uoepsy.github.io/data/BodyTemp.csv')
dim(temp_data)
head(temp_data)


## ---------------------------------------------------------------------------------------------------
xbar <- mean(temp_data$BodyTemp)
xbar


## ---------------------------------------------------------------------------------------------------
s <- sd(temp_data$BodyTemp)
s


## ---------------------------------------------------------------------------------------------------
n <- nrow(temp_data)
n

mu0 <- 37
mu0


## ---------------------------------------------------------------------------------------------------
t_obs <- (xbar - mu0) / (s / sqrt(n))
t_obs


## ---------------------------------------------------------------------------------------------------
terms <- temp_data %>%
  summarise(
    xbar = mean(BodyTemp),
    s = sd(BodyTemp),
    mu0 = 37,
    n = n()
  )

terms


## ---------------------------------------------------------------------------------------------------
qt(c(.025, 0.975), df = 49) # 2.5% in the lower and upper tails. 


## ---------------------------------------------------------------------------------------------------
2 * pt(abs(t_obs), df = 50-1, lower.tail = FALSE)


## ---------------------------------------------------------------------------------------------------
result <- t.test(temp_data$BodyTemp, mu = 37, alternative = "two.sided")
result


## ---------------------------------------------------------------------------------------------------
ggplot(temp_data, aes(x=BodyTemp))+
  geom_histogram()+
  labs(title="Histogram")

ggplot(temp_data, aes(x=BodyTemp))+
  geom_density()+
  labs(title="Density plot")


## ---------------------------------------------------------------------------------------------------
ggplot(temp_data, aes(sample = BodyTemp))+
  geom_qq()+
  geom_qq_line()+
  labs(title="QQ-plot", 
       subtitle="The closer the data fit to the line the more normally distributed they are.",
       x = "Theoretical quantiles",
       y = "Sample quantiles")


## ---------------------------------------------------------------------------------------------------
shapiro.test(temp_data$BodyTemp)


## ---------------------------------------------------------------------------------------------------
pets <- read_csv("https://uoepsy.github.io/data/seattlepets.csv")

summary(pets)


## ---------------------------------------------------------------------------------------------------
dogs <- pets %>% 
    filter(species == "Dog")


## ---------------------------------------------------------------------------------------------------
dogs <- dogs %>% 
  drop_na(weight_kg)


## ---------------------------------------------------------------------------------------------------
dogs <- dogs %>% 
  filter(!is.na(weight_kg))


## ---------------------------------------------------------------------------------------------------
dogstats <- dogs %>% 
  summarise(
    xbar = mean(weight_kg),
    s = sd(weight_kg),
    n = n()
  )
dogstats


## ---------------------------------------------------------------------------------------------------
t_obs <- (dogstats$xbar - 20) / (dogstats$s / sqrt(dogstats$n))
t_obs


## ---------------------------------------------------------------------------------------------------
p_righttail = 1 - pt(t_obs, df = 1332)
p_righttail


## ---------------------------------------------------------------------------------------------------
t.test(x = dogs$weight_kg, mu = 20, alternative = "greater")


## ---------------------------------------------------------------------------------------------------
D <- (dogstats$xbar - 20) / dogstats$s
D


## ---------------------------------------------------------------------------------------------------
library(effectsize)
cohens_d(dogs$weight_kg, mu = 20)


## ---------------------------------------------------------------------------------------------------
cats <- pets %>% 
  filter(species == "Cat", !is.na(weight_kg))


## ---------------------------------------------------------------------------------------------------
shapiro.test(cats$weight_kg)


## ---------------------------------------------------------------------------------------------------
qqnorm(cats$weight_kg)


## ---------------------------------------------------------------------------------------------------
t.test(cats$weight_kg, mu=4.5, alternative="greater")

