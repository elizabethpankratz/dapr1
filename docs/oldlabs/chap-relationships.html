<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Visualising and describing relationships | Data Analysis for Psychology in R 1</title>
  <meta name="description" content="This book contains the lab materials for DAPR-1 at UoE." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Visualising and describing relationships | Data Analysis for Psychology in R 1" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains the lab materials for DAPR-1 at UoE." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Visualising and describing relationships | Data Analysis for Psychology in R 1" />
  
  <meta name="twitter:description" content="This book contains the lab materials for DAPR-1 at UoE." />
  

<meta name="author" content="Department of Psychology, The University of Edinburgh" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-numeric.html"/>
<link rel="next" href="chap-functions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><div style="margin-top:-13px; font-size: 25px; color: #0F4C81;"><left><b>DAPR1</b></left></div></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#team"><i class="fa fa-check"></i>Team</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#textbook"><i class="fa fa-check"></i>Textbook</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html"><i class="fa fa-check"></i>Intro to R, Rstudio, and data in R</a><ul>
<li class="chapter" data-level="0.1" data-path="chap-intro.html"><a href="chap-intro.html#introducing-r-and-rstudio"><i class="fa fa-check"></i><b>0.1</b> Introducing R and Rstudio</a><ul>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#installing"><i class="fa fa-check"></i>Installing</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#first-look-at-rstudio"><i class="fa fa-check"></i>First look at Rstudio</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#r-as-a-calculator"><i class="fa fa-check"></i>R as a calculator</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#r-as-a-calculator-with-a-memory"><i class="fa fa-check"></i>R as a calculator with a memory</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#rscripts-and-rmarkdown"><i class="fa fa-check"></i>Rscripts and Rmarkdown</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#recap"><i class="fa fa-check"></i>Recap</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="chap-intro.html"><a href="chap-intro.html#take-a-breather"><i class="fa fa-check"></i><b>0.2</b> Take a breather</a></li>
<li class="chapter" data-level="0.3" data-path="chap-intro.html"><a href="chap-intro.html#starting-a-new-.rmd-document"><i class="fa fa-check"></i><b>0.3</b> Starting a new .Rmd document</a><ul>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#using-an-r-package"><i class="fa fa-check"></i>Using an R package</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#writing"><i class="fa fa-check"></i>Writing</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="chap-intro.html"><a href="chap-intro.html#data-in-r"><i class="fa fa-check"></i><b>0.4</b> Data in R</a><ul>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#storing-data-in-r-sequences-vectors-of-values"><i class="fa fa-check"></i>Storing data in R: Sequences (“Vectors”) of values</a></li>
<li class="chapter" data-level="" data-path="chap-intro.html"><a href="chap-intro.html#reading-data-into-r"><i class="fa fa-check"></i>Reading data into R</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="chap-intro.html"><a href="chap-intro.html#compiling-a-.rmd-document"><i class="fa fa-check"></i><b>0.5</b> Compiling a .Rmd document</a></li>
<li class="chapter" data-level="0.6" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>0.6</b> Glossary</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-data-types.html"><a href="chap-data-types.html"><i class="fa fa-check"></i><b>1</b> Types of data</a><ul>
<li class="chapter" data-level="1.1" data-path="chap-data-types.html"><a href="chap-data-types.html#accessing-subsections-of-data"><i class="fa fa-check"></i><b>1.1</b> Accessing subsections of data</a><ul>
<li class="chapter" data-level="" data-path="chap-data-types.html"><a href="chap-data-types.html#accessing-by-a-condition"><i class="fa fa-check"></i>Accessing by a condition</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chap-data-types.html"><a href="chap-data-types.html#editing-subsections-of-data"><i class="fa fa-check"></i><b>1.2</b> Editing subsections of data</a><ul>
<li class="chapter" data-level="" data-path="chap-data-types.html"><a href="chap-data-types.html#changing-specific-entries"><i class="fa fa-check"></i>Changing specific entries</a></li>
<li class="chapter" data-level="" data-path="chap-data-types.html"><a href="chap-data-types.html#changing-entries-by-a-condition"><i class="fa fa-check"></i>Changing entries by a condition</a></li>
<li class="chapter" data-level="" data-path="chap-data-types.html"><a href="chap-data-types.html#changing-a-variable"><i class="fa fa-check"></i>Changing a variable</a></li>
<li class="chapter" data-level="" data-path="chap-data-types.html"><a href="chap-data-types.html#removing-rows-or-columns"><i class="fa fa-check"></i>Removing rows or columns</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chap-data-types.html"><a href="chap-data-types.html#different-types-of-data"><i class="fa fa-check"></i><b>1.3</b> Different types of data</a></li>
<li class="chapter" data-level="1.4" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>1.4</b> Glossary</a></li>
<li class="chapter" data-level="1.5" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-categorical.html"><a href="chap-categorical.html"><i class="fa fa-check"></i><b>2</b> Handling categorical data</a><ul>
<li class="chapter" data-level="2.1" data-path="chap-categorical.html"><a href="chap-categorical.html#data-exploration"><i class="fa fa-check"></i><b>2.1</b> Data Exploration</a></li>
<li class="chapter" data-level="2.2" data-path="chap-categorical.html"><a href="chap-categorical.html#unordered-categorical-nominal-data"><i class="fa fa-check"></i><b>2.2</b> Unordered Categorical (Nominal) Data</a><ul>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#frequency-table"><i class="fa fa-check"></i>Frequency table</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#central-tendency"><i class="fa fa-check"></i>Central tendency</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#relative-frequencies"><i class="fa fa-check"></i>Relative frequencies</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#visualising"><i class="fa fa-check"></i>Visualising</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-categorical.html"><a href="chap-categorical.html#ordered-categorical-ordinal-data"><i class="fa fa-check"></i><b>2.3</b> Ordered Categorical (Ordinal) Data</a><ul>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#frequency-table-1"><i class="fa fa-check"></i>Frequency table</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#central-tendency-1"><i class="fa fa-check"></i>Central tendency</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#cumulative-percentages-quartiles"><i class="fa fa-check"></i>Cumulative percentages, Quartiles</a></li>
<li class="chapter" data-level="" data-path="chap-categorical.html"><a href="chap-categorical.html#visualising-1"><i class="fa fa-check"></i>Visualising</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>2.4</b> Glossary</a></li>
<li class="chapter" data-level="2.5" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-numeric.html"><a href="chap-numeric.html"><i class="fa fa-check"></i><b>3</b> Handling numeric data</a><ul>
<li class="chapter" data-level="3.1" data-path="chap-categorical.html"><a href="chap-categorical.html#central-tendency"><i class="fa fa-check"></i><b>3.1</b> Central tendency</a><ul>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#mode-and-median-revisited"><i class="fa fa-check"></i>Mode and median revisited</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#mean"><i class="fa fa-check"></i>Mean</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#summarising-variables"><i class="fa fa-check"></i>Summarising variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chap-numeric.html"><a href="chap-numeric.html#spread"><i class="fa fa-check"></i><b>3.2</b> Spread</a><ul>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#interquartile-range"><i class="fa fa-check"></i>Interquartile range</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#variance"><i class="fa fa-check"></i>Variance</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#standard-deviation"><i class="fa fa-check"></i>Standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chap-categorical.html"><a href="chap-categorical.html#visualising"><i class="fa fa-check"></i><b>3.3</b> Visualising</a><ul>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#histograms"><i class="fa fa-check"></i>Histograms</a></li>
<li class="chapter" data-level="" data-path="chap-numeric.html"><a href="chap-numeric.html#density-curves"><i class="fa fa-check"></i>Density curves</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chap-numeric.html"><a href="chap-numeric.html#skew"><i class="fa fa-check"></i><b>3.4</b> Skew</a></li>
<li class="chapter" data-level="3.5" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>3.5</b> Glossary</a></li>
<li class="chapter" data-level="3.6" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-relationships.html"><a href="chap-relationships.html"><i class="fa fa-check"></i><b>4</b> Visualising and describing relationships</a><ul>
<li class="chapter" data-level="4.1" data-path="chap-relationships.html"><a href="chap-relationships.html#outcome-vs-explanatory"><i class="fa fa-check"></i><b>4.1</b> Outcome vs Explanatory</a></li>
<li class="chapter" data-level="4.2" data-path="chap-relationships.html"><a href="chap-relationships.html#numeric-and-categorical"><i class="fa fa-check"></i><b>4.2</b> Numeric and Categorical</a><ul>
<li class="chapter" data-level="" data-path="chap-relationships.html"><a href="chap-relationships.html#visualising---colours"><i class="fa fa-check"></i>Visualising - Colours</a></li>
<li class="chapter" data-level="" data-path="chap-relationships.html"><a href="chap-relationships.html#visualising---facets"><i class="fa fa-check"></i>Visualising - Facets</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chap-relationships.html"><a href="chap-relationships.html#numeric-and-numeric"><i class="fa fa-check"></i><b>4.3</b> Numeric and Numeric</a><ul>
<li class="chapter" data-level="" data-path="chap-relationships.html"><a href="chap-relationships.html#covariance"><i class="fa fa-check"></i>Covariance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>4.4</b> Glossary</a></li>
<li class="chapter" data-level="4.5" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-functions.html"><a href="chap-functions.html"><i class="fa fa-check"></i><b>5</b> Types of relationships (functions)</a><ul>
<li class="chapter" data-level="5.1" data-path="chap-functions.html"><a href="chap-functions.html#functions"><i class="fa fa-check"></i><b>5.1</b> Functions</a><ul>
<li class="chapter" data-level="" data-path="chap-functions.html"><a href="chap-functions.html#linear-functions"><i class="fa fa-check"></i>Linear functions</a></li>
<li class="chapter" data-level="" data-path="chap-functions.html"><a href="chap-functions.html#non-linear-functions"><i class="fa fa-check"></i>Non-linear functions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chap-functions.html"><a href="chap-functions.html#transformations"><i class="fa fa-check"></i><b>5.2</b> Transformations</a></li>
<li class="chapter" data-level="5.3" data-path="chap-functions.html"><a href="chap-functions.html#centering-and-standardisation"><i class="fa fa-check"></i><b>5.3</b> Centering and Standardisation</a></li>
<li class="chapter" data-level="5.4" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>5.4</b> Glossary</a></li>
<li class="chapter" data-level="5.5" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html"><i class="fa fa-check"></i><b>6</b> Basics of probability theory</a><ul>
<li class="chapter" data-level="" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#where-are-we-going-to"><i class="fa fa-check"></i>Where are we going to?</a></li>
<li class="chapter" data-level="6.1" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section"><i class="fa fa-check"></i><b>6.1</b> Section</a></li>
<li class="chapter" data-level="6.2" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section-1"><i class="fa fa-check"></i><b>6.2</b> Section</a></li>
<li class="chapter" data-level="6.3" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>6.3</b> Glossary</a></li>
<li class="chapter" data-level="6.4" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-probability-rules.html"><a href="chap-probability-rules.html"><i class="fa fa-check"></i><b>7</b> Probability rules</a><ul>
<li class="chapter" data-level="7.1" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section"><i class="fa fa-check"></i><b>7.1</b> Section</a></li>
<li class="chapter" data-level="7.2" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section-1"><i class="fa fa-check"></i><b>7.2</b> Section</a></li>
<li class="chapter" data-level="7.3" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>7.3</b> Glossary</a></li>
<li class="chapter" data-level="7.4" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>7.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-discrete-distributions.html"><a href="chap-discrete-distributions.html"><i class="fa fa-check"></i><b>8</b> Random variables &amp; distributions (discrete)</a><ul>
<li class="chapter" data-level="8.1" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section"><i class="fa fa-check"></i><b>8.1</b> Section</a></li>
<li class="chapter" data-level="8.2" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section-1"><i class="fa fa-check"></i><b>8.2</b> Section</a></li>
<li class="chapter" data-level="8.3" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>8.3</b> Glossary</a></li>
<li class="chapter" data-level="8.4" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>8.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-continuous-distributions.html"><a href="chap-continuous-distributions.html"><i class="fa fa-check"></i><b>9</b> Random variables and distributions (continuous)</a><ul>
<li class="chapter" data-level="9.1" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section"><i class="fa fa-check"></i><b>9.1</b> Section</a></li>
<li class="chapter" data-level="9.2" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section-1"><i class="fa fa-check"></i><b>9.2</b> Section</a></li>
<li class="chapter" data-level="9.3" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>9.3</b> Glossary</a></li>
<li class="chapter" data-level="9.4" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>9.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap-sampling.html"><a href="chap-sampling.html"><i class="fa fa-check"></i><b>10</b> Sampling variability and sampling distributions</a><ul>
<li class="chapter" data-level="10.1" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section"><i class="fa fa-check"></i><b>10.1</b> Section</a></li>
<li class="chapter" data-level="10.2" data-path="chap-probability-theory.html"><a href="chap-probability-theory.html#section-1"><i class="fa fa-check"></i><b>10.2</b> Section</a></li>
<li class="chapter" data-level="10.3" data-path="chap-intro.html"><a href="chap-intro.html#glossary"><i class="fa fa-check"></i><b>10.3</b> Glossary</a></li>
<li class="chapter" data-level="10.4" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises"><i class="fa fa-check"></i><b>10.4</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.handbooks.psy.ed.ac.uk/psychology-1a-and-1b/dapr1" target="blank">Psychology Handbooks</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Psychology in R 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-relationships" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Visualising and describing relationships</h1>
<div class="lo">
<p><strong>LEARNING OBJECTIVES</strong></p>
<ul>
<li>LO1: Understand the relation between X-Y (explanatory/outcome) specification and practical research questions.</li>
<li>L02: Understand how to summarise and visualize numeric-categorical relationships.</li>
<li>LO3: Understand how to summarise and visualize numeric-numeric relationships.</li>
</ul>
</div>
<div id="outcome-vs-explanatory" class="section level2">
<h2><span class="header-section-number">4.1</span> Outcome vs Explanatory</h2>
<p>In the previous two chapters, we looked at how to handle different types of data, and how to describe and visualise categorical and numeric distributions.
More often than not, research involves investigating <em>relationships</em> between variables, rather than studying variables in isolation.</p>
<div class="yellow">
<p>If we are using one variable to help us understand or predict values of another variable, we call the former the <strong>explanatory variable</strong> and the latter the <strong>outcome variable</strong>.</p>
<div style="margin-left: 2em;">
<p><em><strong>Other names</strong></em></p>
<ul>
<li><em>outcome variable = dependent variable = response variable = Y</em></li>
<li><em>explanatory variable = independent variable = predictor variable = X</em></li>
</ul>
<p>(referring to outcome/explanatory variables as <em>Y</em> and <em>X</em> respectively matches up with how we often want to plot them - the outcome variable on the y-axis, and the explanatory variable on the x-axis)</p>
</div>
</div>
<p>The distinction between explanatory and outcome variables is borne out in how we design <strong>experimental studies</strong> - the researcher manipulates the explanatory variable for each unit <em>before</em> the response variable is measured (for instance, we might randomly allocate participants to one of two conditions).
This contrasts with <strong>observational studies</strong> in which the researcher does not control the value of any variable, but simply observes the values as they naturally exist.</p>
<p>We’re going to pick up again with the data collected on the Stroop task from the previous chapter.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="chap-relationships.html#cb252-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb252-2"><a href="chap-relationships.html#cb252-2"></a>stroopdata &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/dapr1/strooptask.csv&quot;</span>)</span>
<span id="cb252-3"><a href="chap-relationships.html#cb252-3"></a></span>
<span id="cb252-4"><a href="chap-relationships.html#cb252-4"></a><span class="co"># calculate the &quot;stroop effect&quot; - the difference in time taken to complete</span></span>
<span id="cb252-5"><a href="chap-relationships.html#cb252-5"></a><span class="co"># the matching vs mismatching sets </span></span>
<span id="cb252-6"><a href="chap-relationships.html#cb252-6"></a>stroopdata &lt;-<span class="st"> </span></span>
<span id="cb252-7"><a href="chap-relationships.html#cb252-7"></a><span class="st">    </span>stroopdata <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb252-8"><a href="chap-relationships.html#cb252-8"></a><span class="st">        </span><span class="kw">mutate</span>(</span>
<span id="cb252-9"><a href="chap-relationships.html#cb252-9"></a>            <span class="dt">stroop_effect =</span> mismatching <span class="op">-</span><span class="st"> </span>matching</span>
<span id="cb252-10"><a href="chap-relationships.html#cb252-10"></a>        )</span></code></pre></div>
<p>The data is experimental - researchers controlled the presentation of the stimuli (coloured words) and the assignment of whether or not participants received practice.</p>
<p>The researchers are interested in two relationships:</p>
<ol style="list-style-type: decimal">
<li>the relationship between receiving practice (<em>categorical</em>) and the stroop-effect (<em>numeric</em>)</li>
<li>the relationship between age (<em>numeric</em>) and the stroop-effect (<em>numeric</em>)</li>
</ol>
</div>
<div id="numeric-and-categorical" class="section level2">
<h2><span class="header-section-number">4.2</span> Numeric and Categorical</h2>
<p>Recall that the “stroop-effect” is the difference (in seconds) between participants’ times on the mismatching set of words vs the matching set. We know how to describe a numeric variable such as the stroop-effect, for instance by calculating the mean and standard deviation, or median and IQR. We saw how to produce visualisations of numeric variables in the form of density curves, histogram, and boxplots.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="chap-relationships.html#cb253-1"></a><span class="co"># take the &quot;stroopdata&quot; dataframe %&gt;%</span></span>
<span id="cb253-2"><a href="chap-relationships.html#cb253-2"></a><span class="co"># summarise() it, such that there is a value called &quot;mean_stroop&quot;, which</span></span>
<span id="cb253-3"><a href="chap-relationships.html#cb253-3"></a><span class="co"># is the mean() of the &quot;stroop_effect&quot; variable, and a value called &quot;sd_stroop&quot;, which</span></span>
<span id="cb253-4"><a href="chap-relationships.html#cb253-4"></a><span class="co"># is the standard deviation of the &quot;stroop_effect&quot; variable.</span></span>
<span id="cb253-5"><a href="chap-relationships.html#cb253-5"></a>stroopdata <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb253-6"><a href="chap-relationships.html#cb253-6"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb253-7"><a href="chap-relationships.html#cb253-7"></a>    <span class="dt">mean_stroop =</span> <span class="kw">mean</span>(stroop_effect),</span>
<span id="cb253-8"><a href="chap-relationships.html#cb253-8"></a>    <span class="dt">sd_stroop =</span> <span class="kw">sd</span>(stroop_effect)</span>
<span id="cb253-9"><a href="chap-relationships.html#cb253-9"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   mean_stroop sd_stroop
##         &lt;dbl&gt;     &lt;dbl&gt;
## 1        7.90      5.02</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="chap-relationships.html#cb255-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> stroop_effect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb255-2"><a href="chap-relationships.html#cb255-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-160-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To understand the relationship between <em>categorical</em> (practice) and the <em>numeric</em> (stroop effect), for now we will simply calculate these summary statistics for the numeric variable when it is split by the different levels in the categorical variable.</p>
<p>In other words, we want to calculate the mean and standard deviation of the <em>stroop_effect</em> variable separately for those observations where <em>practice</em> is “no”, and for those where <em>practice</em> is “yes”:</p>
<table>
<thead>
<tr class="header">
<th align="left">practice</th>
<th align="left">stroop_effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">no</td>
<td align="left">15.19</td>
</tr>
<tr class="even">
<td align="left">no</td>
<td align="left">15.57</td>
</tr>
<tr class="odd">
<td align="left">yes</td>
<td align="left">2.53</td>
</tr>
<tr class="even">
<td align="left">yes</td>
<td align="left">5.27</td>
</tr>
<tr class="odd">
<td align="left">yes</td>
<td align="left">-0.09</td>
</tr>
<tr class="even">
<td align="left">no</td>
<td align="left">9.17</td>
</tr>
<tr class="odd">
<td align="left">yes</td>
<td align="left">6.91</td>
</tr>
<tr class="even">
<td align="left">yes</td>
<td align="left">7.6</td>
</tr>
<tr class="odd">
<td align="left">yes</td>
<td align="left">5.17</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
</tr>
</tbody>
</table>
<p><br>
We can do this using the <code>group_by()</code> function.</p>
<div class="yellow">
<p><strong>group_by()</strong></p>
<p>The <code>group_by()</code> function creates a <em>grouping</em> in the dataframe, so that subsequent functions will be computed <em>on each group.</em></p>
<p>It is most useful in combination with <code>summarise()</code>, to reduce a variable into a summary value <em>for each group in a grouping variable</em>:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="chap-relationships.html#cb256-1"></a><span class="co"># take the data %&gt;%</span></span>
<span id="cb256-2"><a href="chap-relationships.html#cb256-2"></a><span class="co"># make it grouped by each unique value in the &quot;grouping_variable&quot; %&gt;%</span></span>
<span id="cb256-3"><a href="chap-relationships.html#cb256-3"></a><span class="co"># summarise() it FOR EACH GROUP, creating a value called &quot;summary_value&quot; ()</span></span>
<span id="cb256-4"><a href="chap-relationships.html#cb256-4"></a>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-5"><a href="chap-relationships.html#cb256-5"></a><span class="st">  </span><span class="kw">group_by</span>(grouping_variable) <span class="op">%&gt;%</span></span>
<span id="cb256-6"><a href="chap-relationships.html#cb256-6"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb256-7"><a href="chap-relationships.html#cb256-7"></a>    <span class="dt">summary_value =</span> ...</span>
<span id="cb256-8"><a href="chap-relationships.html#cb256-8"></a>  )</span></code></pre></div>
</div>
<p>Let’s do this for the Stroop Task data - we will <code>summarise()</code> the <em>stroop_effect</em> variable, <strong>after</strong> grouping the data by the <em>practice</em> variable:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="chap-relationships.html#cb257-1"></a><span class="co"># take the &quot;stroopdata&quot; %&gt;%</span></span>
<span id="cb257-2"><a href="chap-relationships.html#cb257-2"></a><span class="co"># and group it by each unique value in the &quot;practice&quot; variable (yes/no) %&gt;%</span></span>
<span id="cb257-3"><a href="chap-relationships.html#cb257-3"></a><span class="co"># then summarise() it FOR EACH GROUP, creating summary values called </span></span>
<span id="cb257-4"><a href="chap-relationships.html#cb257-4"></a><span class="co"># &quot;mean_stroop&quot; and &quot;sd_stroop&quot; which are the means and standard deviations of </span></span>
<span id="cb257-5"><a href="chap-relationships.html#cb257-5"></a><span class="co"># the &quot;stroop_effect&quot; variable entries for each group of &quot;practice&quot;.</span></span>
<span id="cb257-6"><a href="chap-relationships.html#cb257-6"></a>stroopdata <span class="op">%&gt;%</span></span>
<span id="cb257-7"><a href="chap-relationships.html#cb257-7"></a><span class="st">  </span><span class="kw">group_by</span>(practice) <span class="op">%&gt;%</span></span>
<span id="cb257-8"><a href="chap-relationships.html#cb257-8"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb257-9"><a href="chap-relationships.html#cb257-9"></a>    <span class="dt">mean_stroop =</span> <span class="kw">mean</span>(stroop_effect),</span>
<span id="cb257-10"><a href="chap-relationships.html#cb257-10"></a>    <span class="dt">sd_stroop =</span> <span class="kw">sd</span>(stroop_effect)</span>
<span id="cb257-11"><a href="chap-relationships.html#cb257-11"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   practice mean_stroop sd_stroop
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1 no             10.0       4.25
## 2 yes             5.52      4.75</code></pre>
<div id="visualising---colours" class="section level3 unnumbered">
<h3>Visualising - Colours</h3>
<div class="question-begin">
Question
</div>
<div class="question-body">
<p>Given the output above, which of the following visualisations is most representative of these statistics?
<img src="labs_files/figure-html/unnamed-chunk-164-1.png" width="672" style="display: block; margin: auto;" /></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Answer<span id="sol-start-148" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-148&#39;, &#39;sol-start-148&#39;)"></span>
</div>
<div id="sol-body-148" class="solution-body" style="display: none;">
<p>We know that the stroop effect for those <em>with</em> practice (blue line) was on average less than those <em>without</em> practice (red line). Both figures A and C don’t fit with this.</p>
<p>In <em>both</em> of the figures B and D, the blue (with practice) distribution peaks at about 5.5, and the red (without practice) distribution peaks at about 10. However, in the figure D, the red distribution is much flatter and wider. It has a larger standard deviation than the blue distribution. In our calculations above, the distributions have very similar standard deviations.<br />
<br>
So the best visualisation of the two means and standard deviations we calculated is figure B.</p>
</div>
<p class="solution-end">
</p>
<p>We can visualise the data using the same code we had before, but with one small addition - we tell ggplot to <em>colour</em> the data according to the different values in the <em>practice</em> variable.<br />
<small>
<strong>Note</strong> we add this inside the <code>aes()</code> mappings, because we are mapping something on the plot (the colour) to something in the data (the <em>practice</em> variable). If we just wanted to make the line blue, we could put <code>col = "blue"</code> <em>outside</em> the <code>aes()</code>.
</small></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="chap-relationships.html#cb259-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> stroop_effect, <span class="dt">col =</span> practice)) <span class="op">+</span></span>
<span id="cb259-2"><a href="chap-relationships.html#cb259-2"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-165-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="visualising---facets" class="section level3 unnumbered">
<h3>Visualising - Facets</h3>
<p>Interpreting two density curves on top of one another works well, but overlaying two histograms on top of one another doesn’t. Instead, we might want to create separate histograms for each set of values (the <em>stroop_effect</em> variable values for each of practice/no practice groups).</p>
<p><code>facet_wrap()</code> is a handy part of <code>ggplot</code> which allows us to easily split one plot into many:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="chap-relationships.html#cb260-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> stroop_effect)) <span class="op">+</span></span>
<span id="cb260-2"><a href="chap-relationships.html#cb260-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb260-3"><a href="chap-relationships.html#cb260-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>practice)</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-166-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="numeric-and-numeric" class="section level2">
<h2><span class="header-section-number">4.3</span> Numeric and Numeric</h2>
<p>When we are interested in the relationship between two <em>numeric</em> variables, such as the one we have between age and the stroop-effect, the most easily interpreted visualisation of this relationship is in the form of a scatterplot:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="chap-relationships.html#cb261-1"></a><span class="co"># make a ggplot with the stroopdata</span></span>
<span id="cb261-2"><a href="chap-relationships.html#cb261-2"></a><span class="co"># put the possible values of the &quot;age&quot; variable on the x axis,</span></span>
<span id="cb261-3"><a href="chap-relationships.html#cb261-3"></a><span class="co"># and put the possible values of the &quot;stroop_effect&quot; variable on the y axis.</span></span>
<span id="cb261-4"><a href="chap-relationships.html#cb261-4"></a><span class="co"># for each entry in the data, add a &quot;tomato1&quot; coloured geom_point() to the plot, </span></span>
<span id="cb261-5"><a href="chap-relationships.html#cb261-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> stroop_effect)) <span class="op">+</span></span>
<span id="cb261-6"><a href="chap-relationships.html#cb261-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span><span class="st">&quot;tomato1&quot;</span>)</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-167-1.png" width="672" style="display: block; margin: auto;" /></p>
The visual pattern that these points make on the plot tells us something about the data - it looks like the older participants tended to have a greater stroop-effect.<br />
But we can also have relationships between two numeric variables that look the opposite, or have no obvious pattern, or have a more consistent patterning (see Figure <a href="chap-relationships.html#fig:numnumrels">4.1</a>)
<div class="figure" style="text-align: center"><span id="fig:numnumrels"></span>
<img src="labs_files/figure-html/numnumrels-1.png" alt="Relationships between two numeric variables can look very different" width="672" />
<p class="caption">
Figure 4.1: Relationships between two numeric variables can look very different
</p>
</div>
<p>As a means of summarising these different types of relationships, we can calculate the <strong>covariance</strong> to describe in what direction, and how strong (i.e., how clear and consistent) the pattern is.</p>
<div id="covariance" class="section level3 unnumbered">
<h3>Covariance</h3>
<p>We know that <strong>variance</strong> is the measure of how much a <em>single numeric variable</em> varies around its mean.<br />
<strong>Covariance</strong> is a measure of how <em>two numeric variables</em> vary together, and can express the directional relationship between them.</p>
<div class="yellow">
<p><strong>Covariance</strong> is the measure of how two variables vary together.<br />
For samples, covariance is calculated using the following formula:</p>
<p><span class="math display">\[\mathrm{cov}(x,y)=\frac{1}{n-1}\sum_{i=1}^n (x_{i}-\bar{x})(y_{i}-\bar{y})\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are two variables;</li>
<li><span class="math inline">\(i\)</span> denotes the observational unit, such that <span class="math inline">\(x_i\)</span> is value that the <span class="math inline">\(x\)</span> variable takes on the <span class="math inline">\(i\)</span>th observational unit, and similarly for <span class="math inline">\(y_i\)</span>;</li>
<li><span class="math inline">\(n\)</span> is the sample size.</li>
</ul>
</div>
<p>It often helps to understand <strong>covariance</strong> by working through a visual explanation.<br />
<br>
Consider the following scatterplot:<br />
<img src="labs_files/figure-html/unnamed-chunk-169-1.png" width="672" style="display: block; margin: auto;" />
<br>
Now let’s superimpose a vertical dashed line at the mean of <span class="math inline">\(x\)</span> (<span class="math inline">\(\bar{x}\)</span>) and a horizontal dashed line at the mean of <span class="math inline">\(y\)</span> (<span class="math inline">\(\bar{y}\)</span>):
<img src="labs_files/figure-html/unnamed-chunk-170-1.png" width="672" style="display: block; margin: auto;" />
<br>
Now let’s pick one of the points, call it <span class="math inline">\(x_i\)</span>, and show <span class="math inline">\((x_{i}-\bar{x})\)</span> and <span class="math inline">\((y_{i}-\bar{y})\)</span>.<br />
Notice that this makes a rectangle.<br />
As <span class="math inline">\((x_{i}-\bar{x})\)</span> and <span class="math inline">\((y_{i}-\bar{y})\)</span> are both positive values, their product - <span class="math inline">\((x_{i}-\bar{x})(y_{i}-\bar{y})\)</span> - is positive.</p>
<p><img src="labs_files/figure-html/unnamed-chunk-171-1.png" width="672" style="display: block; margin: auto;" />
<br>
In fact, for all these points in red, the product <span class="math inline">\((x_{i}-\bar{x})(y_{i}-\bar{y})\)</span> is positive (remember that a negative multiplied by a negative gives a positive):
<img src="labs_files/figure-html/unnamed-chunk-172-1.png" width="672" style="display: block; margin: auto;" />
<br>
And for these points in blue, the product <span class="math inline">\((x_{i}-\bar{x})(y_{i}-\bar{y})\)</span> is negative:<br />
<img src="labs_files/figure-html/unnamed-chunk-173-1.png" width="672" style="display: block; margin: auto;" />
<br>
Now take another look at the formula for covariance:</p>
<p><span class="math display">\[\mathrm{cov}(x,y)=\frac{\sum_{i=1}^n (x_{i}-\bar{x})(y_{i}-\bar{y})}{n-1}\]</span></p>
<p>It is the sum of all these products divided by <span class="math inline">\(n-1\)</span>. It is the average of the products!<br />
<br>
We can easily calculate the covariance between variables in R using the <code>cov()</code> function.
<code>cov()</code> takes two variables <code>cov(x = , y = )</code>.<br />
We can either use the <code>$</code> to pull out the variables from the datset:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="chap-relationships.html#cb262-1"></a><span class="kw">cov</span>(stroopdata<span class="op">$</span>age, stroopdata<span class="op">$</span>stroop_effect)</span></code></pre></div>
<pre><code>## [1] 23.9597</code></pre>
<p>Or we can specify the dataframe, use the <code>%&gt;%</code> symbol, and call <code>cov()</code> inside <code>summarise()</code>:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="chap-relationships.html#cb264-1"></a>stroopdata <span class="op">%&gt;%</span></span>
<span id="cb264-2"><a href="chap-relationships.html#cb264-2"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb264-3"><a href="chap-relationships.html#cb264-3"></a>    <span class="dt">mean_age =</span> <span class="kw">mean</span>(age),</span>
<span id="cb264-4"><a href="chap-relationships.html#cb264-4"></a>    <span class="dt">mean_stroop =</span> <span class="kw">mean</span>(stroop_effect),</span>
<span id="cb264-5"><a href="chap-relationships.html#cb264-5"></a>    <span class="dt">cov_agestroop =</span> <span class="kw">cov</span>(age, stroop_effect)</span>
<span id="cb264-6"><a href="chap-relationships.html#cb264-6"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   mean_age mean_stroop cov_agestroop
##      &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
## 1     42.8        7.90          24.0</code></pre>
<hr />
</div>
</div>
<div id="glossary" class="section level2">
<h2><span class="header-section-number">4.4</span> Glossary</h2>
<ul>
<li><strong>Explanatory variable:</strong> A variable used to understand or predict values of an outcome variable.</li>
<li><strong>Outcome variable:</strong> A variable which we are aiming to understand or predict via some explanatory variable(s).</li>
<li><strong>Scatterplot:</strong> A plot in which the values of two variables are plotted along the two axes, the pattern of the resulting points revealing any relationship which is present.</li>
<li><strong>Covariance:</strong> A measure of the extent to which two variables vary together.
<br><br></li>
<li><code>cov()</code> To calculate the covariance between two variables.</li>
<li><code>group_by()</code> To apply a grouping in a dataframe for each level of a given variable. Grouped dataframes will retain their grouping, so that if we use <code>summarise()</code> it will provide a summary calculation <em>for each group</em>.</li>
<li><code>geom_point()</code> To add points/dots to a ggplot.</li>
<li><code>facet_wrap()</code> To split a ggplot into multiple plots (facets) for each level of a given variable.</li>
<li><h2 id="inline-r-code-introduced-in-the-exercises-below-r-code-which-is-written-in-text-rather-than-inside-a-code-chunk.-when-a-document-with-inline-r-code-is-rendered-the-calculations-are-performed-and-resulting-output-is-placed-within-the-written-text."><span class="header-section-number">4.4</span> <strong>Inline R code</strong> <em>(introduced in the exercises below)</em>: R code which is written in-text, rather than inside a code-chunk. When a document with inline R code is rendered, the calculations are performed and resulting output is placed within the written text.</h2></li>
</ul>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">4.5</span> Exercises</h2>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<ol style="list-style-type: decimal">
<li>Open a new Rmarkdown file, and give it an appropriate title for this chapter.<br />
</li>
<li>In a new code-chunk, load the tidyverse package.<br />
</li>
<li>Now create a new heading of “Stroop task data”.
<ul>
<li><strong>Hint:</strong> remember that we specify headings and subheadings using #, ##, ### etc.</li>
</ul></li>
<li>In a new code-chunk, read in the Stroop task data from <a href="https://uoepsy.github.io/data/dapr1/strooptask.csv" class="uri">https://uoepsy.github.io/data/dapr1/strooptask.csv</a>.<br />
</li>
<li>Add a new variable to the data which is the “stroop-effect” for each observation (the difference in times taken to complete the matching and mismatchings sets of coloured words)</li>
</ol>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 1<span id="sol-start-149" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-149&#39;, &#39;sol-start-149&#39;)"></span>
</div>
<div id="sol-body-149" class="solution-body" style="display: none;">
<p>It should look something like the below:</p>
<p><img src="images/relationships/initrmd.png" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Recall that in this chapter, we visualised the relationship between practice (<em>categorical</em>) and Stroop-effect (<em>numeric</em>) by plotting two density curves overlayed on one another, or two histograms side-by-side.<br />
<br>
What other way might we visualise this relationship?<br />
<strong>Hint:</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="chap-relationships.html#cb266-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> practice, <span class="dt">y =</span> stroop_effect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb266-2"><a href="chap-relationships.html#cb266-2"></a>geom_?????</span></code></pre></div>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 2<span id="sol-start-150" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-150&#39;, &#39;sol-start-150&#39;)"></span>
</div>
<div id="sol-body-150" class="solution-body" style="display: none;">
<p>Take a moment to think - we have visualised numeric variables in a variety of ways: histograms, density curves, and boxplots.<br />
Both histograms and density curves already have values on the y-axis (histograms have “count” on the y, and density curves have “density”).</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="chap-relationships.html#cb267-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> practice, <span class="dt">y =</span> stroop_effect)) <span class="op">+</span></span>
<span id="cb267-2"><a href="chap-relationships.html#cb267-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-177-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Check what other variables there are in the data - use the function <code>names()</code>, and give it your dataframe:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="chap-relationships.html#cb268-1"></a><span class="kw">names</span>(stroopdata)</span></code></pre></div>
<pre><code>## [1] &quot;id&quot;            &quot;age&quot;           &quot;practice&quot;      &quot;matching&quot;      &quot;mismatching&quot;  
## [6] &quot;height&quot;        &quot;stroop_effect&quot;</code></pre>
<p>We also have information recorded on the participants’ heights (measured in cm).<br />
Produce a visualisation of the relationship between height and the Stroop-effect. Before you do so, think about what you expect to see?<br />
Calculate the covariance.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 3<span id="sol-start-151" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-151&#39;, &#39;sol-start-151&#39;)"></span>
</div>
<div id="sol-body-151" class="solution-body" style="display: none;">
<p>We wouldn’t really expect height to influence the Stroop-effect. We can look at the relationship in a scatterplot:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="chap-relationships.html#cb270-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> stroopdata, <span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> stroop_effect)) <span class="op">+</span></span>
<span id="cb270-2"><a href="chap-relationships.html#cb270-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-179-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And the covariance is small (in comparison to the relationship we saw previous between the stroop effect and age):</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="chap-relationships.html#cb271-1"></a><span class="kw">cov</span>(stroopdata<span class="op">$</span>height, stroopdata<span class="op">$</span>stroop_effect)</span></code></pre></div>
<pre><code>## [1] -3.024087</code></pre>
</div>
<p class="solution-end">
</p>
<hr />
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="chap-relationships.html#cb273-1"></a><span class="kw">require</span>(lubridate)</span>
<span id="cb273-2"><a href="chap-relationships.html#cb273-2"></a></span>
<span id="cb273-3"><a href="chap-relationships.html#cb273-3"></a>mm_walk&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;https://data.edinburghopendata.info/dataset/d4a86f41-5e78-48cd-adb8-2064acf93ef0/resource/ffbeb785-a19f-4788-bc27-892b024a6750/download/15middlemeadowwalk.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb273-4"><a href="chap-relationships.html#cb273-4"></a>    <span class="dt">newdate =</span> <span class="kw">dmy</span>(date), </span>
<span id="cb273-5"><a href="chap-relationships.html#cb273-5"></a>    <span class="dt">month =</span> <span class="kw">month</span>(newdate,<span class="dt">label =</span> <span class="ot">TRUE</span>),</span>
<span id="cb273-6"><a href="chap-relationships.html#cb273-6"></a>    <span class="dt">year =</span> <span class="kw">year</span>(newdate),</span>
<span id="cb273-7"><a href="chap-relationships.html#cb273-7"></a>    <span class="dt">day =</span> <span class="kw">day</span>(newdate)</span>
<span id="cb273-8"><a href="chap-relationships.html#cb273-8"></a>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2012</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-9"><a href="chap-relationships.html#cb273-9"></a><span class="st">  </span><span class="kw">group_by</span>(month, day, time) <span class="op">%&gt;%</span></span>
<span id="cb273-10"><a href="chap-relationships.html#cb273-10"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cyclists =</span> <span class="kw">sum</span>(channel_<span class="dv">1</span>)<span class="op">+</span><span class="kw">sum</span>(channel_<span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup <span class="op">%&gt;%</span></span>
<span id="cb273-11"><a href="chap-relationships.html#cb273-11"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">hour =</span> time)</span>
<span id="cb273-12"><a href="chap-relationships.html#cb273-12"></a></span>
<span id="cb273-13"><a href="chap-relationships.html#cb273-13"></a><span class="kw">set.seed</span>(<span class="dv">1345</span>)</span>
<span id="cb273-14"><a href="chap-relationships.html#cb273-14"></a>cycdat&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;https://data.edinburghopendata.info/dataset/d4a86f41-5e78-48cd-adb8-2064acf93ef0/resource/3944c195-947c-4e45-aa21-5a7fea264c52/download/32inverleithrow.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb273-15"><a href="chap-relationships.html#cb273-15"></a>    <span class="dt">newdate =</span> <span class="kw">dmy</span>(date), </span>
<span id="cb273-16"><a href="chap-relationships.html#cb273-16"></a>    <span class="dt">month =</span> <span class="kw">month</span>(newdate,<span class="dt">label =</span> <span class="ot">TRUE</span>),</span>
<span id="cb273-17"><a href="chap-relationships.html#cb273-17"></a>    <span class="dt">year =</span> <span class="kw">year</span>(newdate)</span>
<span id="cb273-18"><a href="chap-relationships.html#cb273-18"></a>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year, month) <span class="op">%&gt;%</span></span>
<span id="cb273-19"><a href="chap-relationships.html#cb273-19"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cyclists =</span> <span class="kw">sum</span>(channel_<span class="dv">1</span>)<span class="op">+</span><span class="kw">sum</span>(channel_<span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb273-20"><a href="chap-relationships.html#cb273-20"></a><span class="st">  </span>ungroup <span class="op">%&gt;%</span></span>
<span id="cb273-21"><a href="chap-relationships.html#cb273-21"></a><span class="st">  </span><span class="kw">bind_rows</span>(</span>
<span id="cb273-22"><a href="chap-relationships.html#cb273-22"></a>  <span class="kw">tibble</span>(<span class="dt">year =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">2014</span>,<span class="dv">12</span>),<span class="kw">rep</span>(<span class="dv">2015</span>,<span class="dv">2</span>)),</span>
<span id="cb273-23"><a href="chap-relationships.html#cb273-23"></a>         <span class="dt">month =</span> <span class="kw">month</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">label=</span>T),</span>
<span id="cb273-24"><a href="chap-relationships.html#cb273-24"></a>         <span class="dt">cyclists =</span> <span class="kw">round</span>(<span class="kw">rnorm</span>(<span class="dv">14</span>,<span class="dv">4725</span>,<span class="dv">1500</span>))</span>
<span id="cb273-25"><a href="chap-relationships.html#cb273-25"></a>  ),</span>
<span id="cb273-26"><a href="chap-relationships.html#cb273-26"></a>  .</span>
<span id="cb273-27"><a href="chap-relationships.html#cb273-27"></a>)</span>
<span id="cb273-28"><a href="chap-relationships.html#cb273-28"></a></span>
<span id="cb273-29"><a href="chap-relationships.html#cb273-29"></a>raindat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://www2.sepa.org.uk/rainfall/api/Month/15201?csv=true&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb273-30"><a href="chap-relationships.html#cb273-30"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb273-31"><a href="chap-relationships.html#cb273-31"></a>        <span class="dt">date =</span> <span class="kw">dmy</span>(<span class="kw">paste0</span>(<span class="st">&quot;01 &quot;</span>, Timestamp)),</span>
<span id="cb273-32"><a href="chap-relationships.html#cb273-32"></a>        <span class="dt">month =</span> <span class="kw">month</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>),</span>
<span id="cb273-33"><a href="chap-relationships.html#cb273-33"></a>        <span class="dt">year =</span> <span class="kw">year</span>(date),</span>
<span id="cb273-34"><a href="chap-relationships.html#cb273-34"></a>        <span class="dt">rainfall_mm =</span> Value</span>
<span id="cb273-35"><a href="chap-relationships.html#cb273-35"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year,month,rainfall_mm)</span>
<span id="cb273-36"><a href="chap-relationships.html#cb273-36"></a></span>
<span id="cb273-37"><a href="chap-relationships.html#cb273-37"></a>inv_row &lt;-<span class="st"> </span><span class="kw">left_join</span>(cycdat, raindat)</span></code></pre></div>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>We’re going to move to a different dataset now, using data from Edinburgh City Council, and from the Scottish Environment Protection Agency.<br />
<br>
Create a new heading in your Rmardkown for “Edinburgh Cyclists”.<br />
<br>
The first dataset we are going to use is the from the Bicycle Counters on Middle Meadow Walk (see Figure <a href="chap-relationships.html#fig:mmwalk">4.2</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:mmwalk"></span>
<img src="images/relationships/mmwalk.jpeg" alt="Photo from \@SustransScot on Twitter, 2017"  />
<p class="caption">
Figure 4.2: Photo from @SustransScot on Twitter, 2017
</p>
</div>
<p>Read in the data <a href="https://uoepsy.github.io/data/dapr1/cycling_mmwalk.csv" class="uri">https://uoepsy.github.io/data/dapr1/cycling_mmwalk.csv</a> and assign it a name of your choice.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 4<span id="sol-start-152" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-152&#39;, &#39;sol-start-152&#39;)"></span>
</div>
<div id="sol-body-152" class="solution-body" style="display: none;">
<p>We’re going to assign it the name “mm_walk”.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="chap-relationships.html#cb274-1"></a>mm_walk &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/dapr1/cycling_mmwalk.csv&quot;</span>)</span></code></pre></div>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>The data contains information on the total number of cyclists travelling in either direction on Middle Meadow Walk for each hour of each day in 2012.</p>
<p>Plot the relationship between hour of day and the number of cyclists.<br />
<strong>Tip:</strong> You will want to make the hour of day a <strong>factor</strong> first, so that R treats it as different levels.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 5<span id="sol-start-153" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-153&#39;, &#39;sol-start-153&#39;)"></span>
</div>
<div id="sol-body-153" class="solution-body" style="display: none;">
<p>Currently, the <em>hour</em> variable is numeric, and R won’t know that we want a separate boxplot for each hour:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="chap-relationships.html#cb275-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mm_walk, <span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> cyclists)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb275-2"><a href="chap-relationships.html#cb275-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-183-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>What we need to do is make the <em>hour</em> variable a factor:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="chap-relationships.html#cb276-1"></a>mm_walk<span class="op">$</span>hour &lt;-<span class="st"> </span><span class="kw">factor</span>(mm_walk<span class="op">$</span>hour)</span></code></pre></div>
<p>OR</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="chap-relationships.html#cb277-1"></a>mm_walk &lt;-<span class="st"> </span></span>
<span id="cb277-2"><a href="chap-relationships.html#cb277-2"></a><span class="st">  </span>mm_walk <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb277-3"><a href="chap-relationships.html#cb277-3"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb277-4"><a href="chap-relationships.html#cb277-4"></a>    <span class="dt">hour =</span> <span class="kw">factor</span>(hour)</span>
<span id="cb277-5"><a href="chap-relationships.html#cb277-5"></a>  )</span></code></pre></div>
<p>and then plot it. Note that ggplot now knows to create a separate boxplot for each hour:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="chap-relationships.html#cb278-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mm_walk, <span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> cyclists)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb278-2"><a href="chap-relationships.html#cb278-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-186-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Using <code>group_by()</code> and <code>summarise()</code>, you can <em>aggregate</em> the data in to grouped averages (using <code>mean()</code>), or grouped totals (using <code>sum()</code>).</p>
<ol style="list-style-type: decimal">
<li>Which month had the highest total number of cyclists?<br />
</li>
<li>Which hour of the day had the highest average number of cyclists?</li>
</ol>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 6<span id="sol-start-154" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-154&#39;, &#39;sol-start-154&#39;)"></span>
</div>
<div id="sol-body-154" class="solution-body" style="display: none;">
<p>To calculate the total number of cyclists in each month, we want to:
1. group by the month<br />
2. add together (<em>sum</em>) all the numbers of cyclists in that month</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="chap-relationships.html#cb279-1"></a>mm_walk <span class="op">%&gt;%</span></span>
<span id="cb279-2"><a href="chap-relationships.html#cb279-2"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span></span>
<span id="cb279-3"><a href="chap-relationships.html#cb279-3"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb279-4"><a href="chap-relationships.html#cb279-4"></a>    <span class="dt">monthly_cyclists =</span> <span class="kw">sum</span>(cyclists)</span>
<span id="cb279-5"><a href="chap-relationships.html#cb279-5"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    month monthly_cyclists
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 Apr              37707
##  2 Aug              55165
##  3 Dec              23507
##  4 Feb              38781
##  5 Jan              33517
##  6 Jul              36707
##  7 Jun              39379
##  8 Mar              50997
##  9 May              46364
## 10 Nov              43962
## 11 Oct              49160
## 12 Sep              44351</code></pre>
<p>August had the most cyclists, with 55,165. August tends to be the busiest month in Edinburgh because of the festival.</p>
<p>To calculate the average number of cyclists in each hour of the day, we want to:
1. group by the hour of the day
2. calculate the average of the numbers of cyclists for each hour</p>
<p><strong>Tip:</strong> we can use <code>arrange(somevariable)</code> order our data from smallest to largest according to “somevariable”, and by adding in <code>desc()</code> too, we can go from largest to smallest!</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="chap-relationships.html#cb281-1"></a>mm_walk <span class="op">%&gt;%</span></span>
<span id="cb281-2"><a href="chap-relationships.html#cb281-2"></a><span class="st">  </span><span class="kw">group_by</span>(hour) <span class="op">%&gt;%</span></span>
<span id="cb281-3"><a href="chap-relationships.html#cb281-3"></a><span class="st">  </span><span class="kw">summarise</span>(</span>
<span id="cb281-4"><a href="chap-relationships.html#cb281-4"></a>    <span class="dt">avg_cyclists =</span> <span class="kw">mean</span>(cyclists)</span>
<span id="cb281-5"><a href="chap-relationships.html#cb281-5"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb281-6"><a href="chap-relationships.html#cb281-6"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(avg_cyclists))</span></code></pre></div>
<pre><code>## # A tibble: 24 x 2
##    hour  avg_cyclists
##    &lt;fct&gt;        &lt;dbl&gt;
##  1 17           144. 
##  2 8            139. 
##  3 18           113. 
##  4 16           108. 
##  5 9            104. 
##  6 15            84.2
##  7 13            76.6
##  8 14            76.0
##  9 19            71.0
## 10 12            69.2
## # … with 14 more rows</code></pre>
<p>Matching the plot we made in the previous question, there are two peak hours - 8am and 5pm. 5pm has a slightly higher <em>mean</em> number of cyclists, with 143.</p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Another dataset, available at <a href="https://uoepsy.github.io/data/dapr1/cycling_invrow.csv" class="uri">https://uoepsy.github.io/data/dapr1/cycling_invrow.csv</a>, contains information on the total number of cyclists each month from 2014 to 2016 on Inverleith Row, Edinburgh. It also contains data on the monthly rainfall (in millimetres) measured at the nearby Royal Botanic Gardens.</p>
<p>Read the data into R, and produce a visualisation of the relationship between monthly rainfall and monthly cyclists.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 7<span id="sol-start-155" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-155&#39;, &#39;sol-start-155&#39;)"></span>
</div>
<div id="sol-body-155" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="chap-relationships.html#cb283-1"></a>inv_row &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/dapr1/cycling_invrow.csv&quot;</span>)</span>
<span id="cb283-2"><a href="chap-relationships.html#cb283-2"></a></span>
<span id="cb283-3"><a href="chap-relationships.html#cb283-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> inv_row, <span class="kw">aes</span>(<span class="dt">x =</span> rainfall_mm, <span class="dt">y =</span> cyclists))<span class="op">+</span></span>
<span id="cb283-4"><a href="chap-relationships.html#cb283-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 8 - Harder
</div>
<div class="question-body">
<p>Make a new heading of “Pulse rate and exercise”.<br />
Read in a new dataset from <a href="https://uoepsy.github.io/data/dapr1/pulse.csv" class="uri">https://uoepsy.github.io/data/dapr1/pulse.csv</a>.</p>
<p>Check out the data codebook at <a href="https://uoepsy.github.io/data/dapr1/#pulsecsv">here</a>.</p>
<p>Explore <em>visually</em> the relationship between active and resting pulse rate and the variables which influence resting pulse rate.<br />
For each plot you make:</p>
<ul>
<li>Think about what variable we are assuming to influence another. Which should be on the x-axis, and which on the y?<br />
</li>
<li>Think about what type of measurement each variable is - e.g., numeric, categorical. How is it best to visualise each relationship?<br />
</li>
<li>Try to make your plots easily interpretable (for instance, add useful axes and titles using <code>labs(title = "---", x = "---", y = "---")</code>), and aesthetically pleasing (try out some of the different <a href="https://www.datanovia.com/en/blog/ggplot-themes-gallery/">themes</a>).</li>
</ul>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 8<span id="sol-start-156" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-156&#39;, &#39;sol-start-156&#39;)"></span>
</div>
<div id="sol-body-156" class="solution-body" style="display: none;">
<p>Read in the data:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="chap-relationships.html#cb284-1"></a>pulse &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://uoepsy.github.io/data/dapr1/pulse.csv&quot;</span>)</span></code></pre></div>
<p>Visualise the relationship between resting and active pulse rate. This should just be a scatterplot:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="chap-relationships.html#cb285-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> rest, <span class="dt">y =</span> active)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb285-2"><a href="chap-relationships.html#cb285-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb285-3"><a href="chap-relationships.html#cb285-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relationship between resting and active pulse rate&quot;</span>,<span class="dt">x =</span> <span class="st">&quot;Resting pulse&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Pulse after exercise&quot;</span>)<span class="op">+</span></span>
<span id="cb285-4"><a href="chap-relationships.html#cb285-4"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-191-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For a visual exploration, we now want to create similar plots between each variable and the <em>rest</em> variable, to see which ones we see patterns in.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="chap-relationships.html#cb286-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> sex, <span class="dt">y =</span> rest)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb286-2"><a href="chap-relationships.html#cb286-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-192-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="chap-relationships.html#cb287-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> smoke, <span class="dt">y =</span> rest)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb287-2"><a href="chap-relationships.html#cb287-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-192-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>When you look at the data, you’ll notice that because the exercise per week is rounded to the nearest hour, there are actually only three different distinct values (1, 2, or 3). A scatterplot might have initially seemed the best choice (because we think of hours per week as <em>numeric</em>). However, a boxplot might be more convenient.<br />
Note that we have <code>x = factor(exercise)</code> in the code below. This temporarily makes the <em>exercise</em> variable a factor (for the plot <em>only</em>, and making no permanent changes to the dataframe itself).</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="chap-relationships.html#cb288-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(exercise), <span class="dt">y =</span> rest)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb288-2"><a href="chap-relationships.html#cb288-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-193-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="chap-relationships.html#cb289-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> hgt, <span class="dt">y =</span> rest)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb289-2"><a href="chap-relationships.html#cb289-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-194-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="chap-relationships.html#cb290-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pulse, <span class="kw">aes</span>(<span class="dt">x =</span> wgt, <span class="dt">y =</span> rest)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb290-2"><a href="chap-relationships.html#cb290-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="labs_files/figure-html/unnamed-chunk-194-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>We’re going to now learn about how to write a paragraph of text with embedded calculations. Each time we render the document, the calculations get performed and the ouput gets created. This is really useful as it means we can write a report which we can really easily update if we change our analysis, or include more data.</p>
Instead of writing in code-chunks, as we have been, we can also write <strong>inline R code</strong>, which we specify as shown in Figure <a href="chap-relationships.html#fig:inlinepng">4.3</a>.<br />

<div class="figure" style="text-align: center"><span id="fig:inlinepng"></span>
<img src="images/relationships/inline.png" alt="Writing Inline R code. The code on the left gets compiled to look like what is shown on the right (source: https://rmarkdown.rstudio.com/authoring_quick_tour.html)"  />
<p class="caption">
Figure 4.3: Writing Inline R code. The code on the left gets compiled to look like what is shown on the right (source: <a href="https://rmarkdown.rstudio.com/authoring_quick_tour.html" class="uri">https://rmarkdown.rstudio.com/authoring_quick_tour.html</a>)
</p>
</div>
Write the paragraph below, and fill in the blanks with inline R code.<br />
<br>
<center>
The average resting pulse was <strong>????</strong>, with a standard deviation of <strong>????</strong>. Heights of participants in the study ranged from <strong>????</strong> to <strong>????</strong>, with a median of <strong>????</strong> and an IQR of <strong>????</strong>.
</center>
<p><br>
<small>
<strong>Tip:</strong> for writing inline code, often using code like <code>mean(data$variable)</code> is easier, because it is more compact than <code>data %&gt;% summarise(mean = mean(variable)) %&gt;% pull(mean)</code>.<br />
</small></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution 9<span id="sol-start-157" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-157&#39;, &#39;sol-start-157&#39;)"></span>
</div>
<div id="sol-body-157" class="solution-body" style="display: none;">
<p>Note that we have also used <code>round(2)</code> every now and then, to round the results to 2 decimal places.
<img src="images/relationships/inline2.png" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<hr />
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>Final task for this chapter!</p>
<p>Compile your Rmarkdown document into an html. Remember that you can do this using the “Knit” button at the top.<br />
<br>
You’ll notice that as the <strong>.html</strong> file shows up in the files tab in the bottom-right of Rstudio.<br />
Make sure that your inline R code is displaying correctly.<br />
<br>
Upload your <em>.html</em> to the discussion board, so we can all admire each other’s lovely ggplots!</p>
<p class="question-end">
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-numeric.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["labs.pdf", "labs.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
